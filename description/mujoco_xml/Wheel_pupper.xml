<mujoco model="pupper_v3">
    <!-- Keyframes -->
    <keyframe>
        <key name="home"
            qpos="0 0 0.28             1 0 0 0             0.0 0.0 0.0             0.0 0.0 0.0             0.0 0.0 0.0             0.0 0.0 0.0"
            ctrl="0.0 0.0 0.0             0.0 0.0 0.0             0.0 0.0 0.0             0.0 0.0 0.0" />
    </keyframe>
    <!-- Visual Assets -->
    <asset>
        <texture type="skybox" builtin="gradient" rgb1=".3 .5 .7" rgb2="0 0 0" width="512"
            height="512" />
        <texture name="grid" type="2d" builtin="checker" width="512" height="512" rgb1=".2 .4 .6"
            rgb2=".4 .6 .8" />
        <material name="grid" texture="grid" texrepeat="1 1" texuniform="true" reflectance="0" />
    </asset>
    <!-- Sensors -->
    <sensor>
        <framequat name="body_quat" objtype="site" objname="body_imu_site" />
        <gyro name="body_gyro" site="body_imu_site" />
        <accelerometer name="body_acc" site="body_imu_site" />
        <framequat objtype="site" objname="body_imu_site" name="orientation" />
        <framepos objtype="site" objname="body_imu_site" name="global_position" />
        <framelinvel objtype="site" objname="body_imu_site" name="global_linvel" />
        <frameangvel objtype="site" objname="body_imu_site" name="global_angvel" />
    </sensor>


    <!-- Actuators -->
    <actuator>
        <general joint="leg_front_r_1" name="leg_front_r_1" />
        <general joint="leg_front_r_2" name="leg_front_r_2" />
        <general joint="Wheel_FR" name="Wheel_FR" class="wheel" gainprm="-1.0 0 0" />

        <general joint="leg_front_l_1" name="leg_front_l_1" />
        <general joint="leg_front_l_2" name="leg_front_l_2" />
        <general joint="Wheel_FL" name="Wheel_FL" class="wheel" gainprm="1.0 0 0" />

        <general joint="leg_back_r_1" name="leg_back_r_1" />
        <general joint="leg_back_r_2" name="leg_back_r_2" />
        <general joint="Wheel_BR" name="Wheel_BR" class="wheel" gainprm="-1.0 0 0" />

        <general joint="leg_back_l_1" name="leg_back_l_1" />
        <general joint="leg_back_l_2" name="leg_back_l_2" />
        <general joint="Wheel_BL" name="Wheel_BL" class="wheel" gainprm="1.0 0 0" />
    </actuator>

    
    <!-- Default Settings -->
    <default>
        <general forcerange="-3 3" forcelimited="true" biastype="affine" gainprm="5.0 0 0"
            biasprm="0 -5.0 -0.1" ctrlrange="-5 5" ctrllimited="true" />


        <!-- visual geom will go to group 4 -->
        <geom condim="3" contype="0" conaffinity="0" group="4" />

        <!-- collision geom in group 3 -->
        <default class="collision">
            <geom group="3" contype="1" conaffinity="1" solimp="0.015 1 0.031"
                friction="0.8 0.02 0.01" />
        </default>

        <default class="wheel">
            <joint limited="false" />
            <!-- Velocity control: F = kd * (ctrl - dq). Gain=1.0 is kd. -->
            <!-- Velocity control default -->
            <general ctrllimited="false" biasprm="0 0 -1.0"/>
        </default>

        <joint armature="0.0016" type="hinge" damping="0.01" frictionloss="0.125" limited="true" />
    </default>
    <!-- Simulation Options -->
    <option cone="pyramidal" impratio="10" iterations="2" ls_iterations="5" timestep="0.004">
        <flag eulerdamp="disable" />
    </option>
    <!-- Compiler Settings -->
    <compiler angle="radian" meshdir="../meshes/stl/" autolimits="true" />
    <!-- Mesh Assets -->
    <asset>
        <mesh name="BodyV4v70_001" file="BodyV4v70_001.stl" />
        <mesh name="LegAssemblyForFlangedv26_001" file="LegAssemblyForFlangedv26_001.stl" />
        <mesh name="LegAssemblyForFlangedv26_002" file="LegAssemblyForFlangedv26_002.stl" />
        <mesh name="FR_WheelMesh" file="Wheels.stl" />
        <mesh name="LegAssemblyForFlangedv26_010" file="LegAssemblyForFlangedv26_010.stl"
            scale="1 -1 1" />
        <mesh name="LegAssemblyForFlangedv26_011" file="LegAssemblyForFlangedv26_011.stl"
            scale="1 1 -1" />
        <mesh name="FL_WheelMesh" file="Wheels.stl"
            scale="1 1 -1" />
        <mesh name="LegAssemblyForFlangedv26_005" file="LegAssemblyForFlangedv26_005.stl" />
        <mesh name="LegAssemblyForFlangedv26_006" file="LegAssemblyForFlangedv26_006.stl" />
        <mesh name="BR_WheelMesh" file="Wheels.stl" />
        <mesh name="LegAssemblyForFlangedv26_013" file="LegAssemblyForFlangedv26_013.stl"
            scale="1 -1 1" />
        <mesh name="LegAssemblyForFlangedv26_014" file="LegAssemblyForFlangedv26_014.stl"
            scale="1 1 -1" />
        <mesh name="BL_WheelMesh" file="Wheels.stl"
            scale="1 1 -1" />
    </asset>


    <!-- Worldbody -->
    <worldbody>
        <!-- Base Link -->
        <body name="base_link" pos="0 0 0.13" gravcomp="0">
            <inertial pos="0.025 0 0.015" quat="0 0.677807 0 0.73524" mass="1.506"
                diaginertia="0.00854071 0.0085 0.00235929" />
            <freejoint name="world_to_body" />
            <!-- <geom size="0.04507 0.06379 0.129715" pos="0.02146 0 0.03345"
                quat="0.499998 -0.5 -0.500002 0.5" type="box" class="collision" /> -->
            <geom quat="0.499998 -0.5 -0.500002 0.5" type="mesh" contype="0" conaffinity="0"
                group="1" density="0" mesh="BodyV4v70_001" />


            <!-- Front Right Leg - Part 1 -->
            <body name="leg_front_r_1" pos="0.075 -0.0835 0" euler="1.57 0 1"
                gravcomp="0">
                <inertial pos="0 0 0" mass="0.18" diaginertia="7.4e-05 5.8e-05 4.8e-05" />
                <joint name="leg_front_r_1" pos="0 0 0" axis="0 0 1" range="-2.22 1.51" />
                <geom pos="0 0 -0.028" quat="1.32679e-06 0 0 1" type="mesh" contype="0"
                    conaffinity="0" group="1" density="0" mesh="LegAssemblyForFlangedv26_001" />

                    <!-- Front Right Leg - Part 2 -->
                    <body name="leg_front_r_2" pos="0 0 0"
                    quat="0.707107 2.24089e-06 -0.707107 4.83018e-06" gravcomp="0">
                    <inertial pos="0 -0.0334 0.05419" quat="0.903877 0.427791 0 0" mass="0.186"
                        diaginertia="0.000113 9.74951e-05 4.65049e-05" />
                    <joint name="leg_front_r_2" pos="0 0 0" axis="0 0 1" range="-0.42 3.14" />
                    <geom size="0.025" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0"
                        type="sphere" class="collision" />
                    <geom pos="-0.028 0 0" quat="-2.93388e-06 0.707108 2.26082e-06 0.707106"
                        type="mesh" contype="0" conaffinity="0" group="1" density="0"
                        mesh="LegAssemblyForFlangedv26_002" />

                    <!-- Front Right Wheel - Part 3 -->
                    <body name="Wheel_FR" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0" gravcomp="0" >
                        <inertial pos="0 0 0.035" mass="0.05" diaginertia="2.75142e-5 2.75142e-5 4.93951e-5" />
                        <joint name="Wheel_FR" pos="0 0 0" axis="0 0 1" class="wheel" />
                        <geom size="0.04445 0.013" pos="0 0 0.035" type="capsule" class="collision" />
                        <geom pos="0 0 0.035" euler="0 -1.5708 1.5708" type="mesh"
                            contype="0" conaffinity="0" group="1" density="0"
                            mesh="FR_WheelMesh" />
                        <site name="leg_front_r_3_foot_site" pos="0 0 0.035" />
                    </body>
                </body>
            </body>


            <!-- Front Left Leg - Part 1 -->
            <body name="leg_front_l_1" pos="0.075 0.0835 0" euler="-1.57 0 -1"
                gravcomp="0">
                <inertial pos="0 0 0" mass="0.18" diaginertia="7.4e-05 5.8e-05 4.8e-05" />
                <joint name="leg_front_l_1" pos="0 0 0" axis="0 0 -1" range="-2.22 1.51" />
                <geom pos="0 0 -0.028" quat="1.32679e-06 0 0 1" type="mesh" contype="0"
                    conaffinity="0" group="1" density="0" mesh="LegAssemblyForFlangedv26_010" />

                    <!-- Front Left Leg - Part 2 -->
                    <body name="leg_front_l_2" pos="0 0 0"
                    quat="-3.89602e-06 0.707107 -1.29867e-06 -0.707107" gravcomp="0">
                    <inertial pos="0 -0.0334 0.05419" quat="0.903877 0.427791 0 0" mass="0.186"
                        diaginertia="0.000113 9.74951e-05 4.65049e-05" />
                    <joint name="leg_front_l_2" pos="0 0 0" axis="0 0 -1" range="-0.42 3.14" />
                    <geom size="0.025" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0"
                        type="sphere" class="collision" />
                    <geom pos="0.028 0 0" quat="-2.93388e-06 0.707108 2.26082e-06 0.707106"
                        type="mesh" contype="0" conaffinity="0" group="1" density="0"
                        mesh="LegAssemblyForFlangedv26_011" />

                    <!-- Front Left Wheel - Part 3 -->
                    <body name="Wheel_FL" pos="0 -0.0494 0.0685"
                        quat="9.38184e-07 -0.707108 9.38187e-07 0.707105" gravcomp="0">
                        <inertial pos="0 0 0.035" mass="0.05" diaginertia="2.75142e-5 2.75142e-5 4.93951e-5" />
                        <joint name="Wheel_FL" pos="0 0 0" axis="0 0 -1" class="wheel" />
                        <geom size="0.04445 0.013" pos="0 0 0.035" type="capsule" class="collision" />
                        <geom pos="0 0 0.035" euler="0 -1.5708 1.5708" type="mesh"
                            contype="0" conaffinity="0" group="1" density="0"
                            mesh="FL_WheelMesh" />
                        <site name="leg_front_l_3_foot_site" pos="0 0 0.035" />
                    </body>
                </body>
            </body>


            <!-- Back Right Leg - Part 1 -->
            <body name="leg_back_r_1" pos="-0.075 -0.0725 0" euler="1.57 0 0.6"
                gravcomp="0">
                <inertial pos="0 0 0" mass="0.18" diaginertia="7.4e-05 5.8e-05 4.8e-05" />
                <joint name="leg_back_r_1" pos="0 0 0" axis="0 0 1" range="-1.82 1.91" />
                <geom pos="0 0 -0.028" quat="1.32679e-06 0 0 1" type="mesh" contype="0"
                    conaffinity="0" group="1" density="0" mesh="LegAssemblyForFlangedv26_005" />

                    <!-- Back Right Leg - Part 2 -->
                    <body name="leg_back_r_2" pos="0 0 0"
                    quat="0.707107 2.24089e-06 -0.707107 4.83018e-06" gravcomp="0">
                    <inertial pos="0 -0.0334 0.05419" quat="0.903877 0.427791 0 0" mass="0.186"
                        diaginertia="0.000113 9.74951e-05 4.65049e-05" />
                    <joint name="leg_back_r_2" pos="0 0 0" axis="0 0 1" range="-0.42 3.14" />
                    <geom size="0.025" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0"
                        type="sphere" class="collision" />
                    <geom pos="-0.028 0 0" quat="-2.93388e-06 0.707108 2.26082e-06 0.707106"
                        type="mesh" contype="0" conaffinity="0" group="1" density="0"
                        mesh="LegAssemblyForFlangedv26_006" />

                    <!-- Back Right Wheel - Part 3 -->
                    <body name="Wheel_BR" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0"
                        gravcomp="0">
                        <inertial pos="0 0 0.035" mass="0.05" diaginertia="2.75142e-5 2.75142e-5 4.93951e-5" />
                        <joint name="Wheel_BR" pos="0 0 0" axis="0 0 1" class="wheel" />
                        <geom size="0.04445 0.013" pos="0 0 0.035" type="capsule" class="collision" />
                        <geom pos="0 0 0.035" euler="0 -1.5708 1.5708" type="mesh"
                            contype="0" conaffinity="0" group="1" density="0"
                            mesh="BR_WheelMesh" />
                        <site name="leg_back_r_3_foot_site" pos="0 0 0.035" />
                    </body>
                </body>
            </body>


            <!-- Back Left Leg - Part 1 -->
            <body name="leg_back_l_1" pos="-0.075 0.0725 0" euler="-1.57 0 -0.6"
                gravcomp="0">
                <inertial pos="0 0 0" mass="0.18" diaginertia="7.4e-05 5.8e-05 4.8e-05" />
                <joint name="leg_back_l_1" pos="0 0 0" axis="0 0 -1" range="-1.82 1.91" />
                <geom pos="0 0 -0.028" quat="1.32679e-06 0 0 1" type="mesh" contype="0"
                    conaffinity="0" group="1" density="0" mesh="LegAssemblyForFlangedv26_013" />

                    <!-- Back Left Leg - Part 2 -->
                    <body name="leg_back_l_2" pos="0 0 0"
                    quat="-3.89602e-06 0.707107 -1.29867e-06 -0.707107" gravcomp="0">
                    <inertial pos="0 -0.0334 0.05419" quat="0.903877 0.427791 0 0" mass="0.186"
                        diaginertia="0.000113 9.74951e-05 4.65049e-05" />
                    <joint name="leg_back_l_2" pos="0 0 0" axis="0 0 -1" range="-0.42 3.14" />
                    <geom size="0.025" pos="0 -0.0494 0.0685" quat="0.707105 0 0.707108 0"
                        type="sphere" class="collision" />
                    <geom pos="0.028 0 0" quat="-2.93388e-06 0.707108 2.26082e-06 0.707106"
                        type="mesh" contype="0" conaffinity="0" group="1" density="0"
                        mesh="LegAssemblyForFlangedv26_014" />

                    <!-- Back Left Wheel - Part 3 -->
                    <body name="Wheel_BL" pos="0 -0.0494 0.0685"
                        quat="9.38184e-07 -0.707108 9.38187e-07 0.707105" gravcomp="0">
                        <inertial pos="0 0 0.035" mass="0.05" diaginertia="2.75142e-5 2.75142e-5 4.93951e-5" />
                        <joint name="Wheel_BL" pos="0 0 0" axis="0 0 -1" class="wheel" />
                        <geom size="0.04445 0.013" pos="0 0 0.035" type="capsule" class="collision" />
                        <geom pos="0 0 0.035" euler="0 -1.5708 1.5708" type="mesh"
                            contype="0" conaffinity="0" group="1" density="0"
                            mesh="BL_WheelMesh" />
                        <site name="leg_back_l_3_foot_site" pos="0 0 0.035" />
                    </body>
                </body>
            </body>
            <site name="body_imu_site" pos="0.09 0 0.032" />
        </body>


        <!-- Environment -->
        <geom name="floor" size="0 0 .05" type="plane" material="grid" condim="3" contype="1"
            conaffinity="1" />
        <geom name="floor_visual" size="0 0 .05" pos="0 0 -0.001" type="plane" material="grid"
            condim="3" contype="0" conaffinity="0" group="1" />
        <light name="spotlight" mode="targetbodycom" target="base_link" diffuse="0.9 0.9 0.9"
            specular="0.3 0.3 0.3" pos="0 -4 4" cutoff="100" />
        <camera name="tracking_cam" mode="targetbody" target="base_link" pos="0.5 -0.5 0.5" />
    </worldbody>


    <!-- Custom Settings -->
    <custom>
        <numeric data="5" name="max_contact_points" />
        <numeric data="4" name="max_geom_pairs" />
    </custom>
</mujoco>